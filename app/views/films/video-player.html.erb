<!DOCTYPE html>
<!-- This site was created in Webflow. https://www.webflow.com -->
<!-- Last Published: Wed Nov 29 2023 19:01:33 GMT+0000 (Coordinated Universal Time) -->
<html data-wf-page="65556c3d75f4578c98878f43" data-wf-site="6552fd9da7543edd2fe97c76">
<head>
  <meta charset="utf-8">
  <title>Video Player</title>
  <meta content="Video Player" property="og:title">
  <meta content="Video Player" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <%= stylesheet_link_tag 'normalize' %>
  <%= stylesheet_link_tag 'webflow' %>
  <%= stylesheet_link_tag 'miless-fantabulous-site-598a20.webflow.css' %>
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">
    WebFont.load({
      google: {
        families: ["Varela Round:400","Lato:100,100italic,300,300italic,400,400italic,700,700italic,900,900italic"]
      }
    });
  </script>
  <script type="text/javascript">
    !function(o,c){
      var n=c.documentElement,t=" w-mod-";
      n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")
    }(window,document);
  </script>
  <link href="images/favicon.png" rel="shortcut icon" type="image/x-icon">
  <link href="images/webclip.png" rel="apple-touch-icon">

  <style>
    /* Styling for "Add to Favorites" button */
    .favorite-button.add {
      background-color: #03C5CD; /* Sky blue background color */
      color: #fff; /* White text color */
      border: none; /* Remove button border if needed */
      padding: 10px 20px; /* Adjust padding as needed */
      border-radius: 5px; /* Add border radius for rounded corners */
      font-weight: bold; /* Adjust font weight as needed */
      margin-right: 2px; /* Add right margin for spacing */
      /* Add any other custom styles you want */
    }

    .favorite-button.add:hover {
      background-color: #029DA4; /* Lighter blue on hover */
      /* Add any other hover styles you want */
    }

    /* Styling for "Remove from Favorites" button */
    .favorite-button.remove {
      background-color: #03C5CD; /* Light red background color */
      color: #fff; /* White text color */
      border: none; /* Remove button border if needed */
      padding: 10px 20px; /* Adjust padding as needed */
      border-radius: 5px; /* Add border radius for rounded corners */
      font-weight: bold; /* Adjust font weight as needed */
      margin-left: 2px; /* Add left margin for spacing */
      /* Add any other custom styles you want */
    }

    .favorite-button.remove:hover {
      background-color: #029DA4; /* Lighter red on hover */
      /* Add any other hover styles you want */
    }

    .empty-div {
      margin-top: 20px;
      margin-bottom: 20px;
      height: 20px; /* Adjust the height as needed */
      background-color: transparent; /* You can change the background color */
    }

    .empty-div-2 {
      margin-top: 10px;
      margin-bottom: 10px;
      height: 10px; /* Adjust the height as needed */
      background-color: transparent; /* You can change the background color */
    }

    .logo {
      width: 100px;
      padding-top: 10px;
      padding-bottom: 10px;
      transition: filter 0.3s ease-in-out;
    }

    .logo:hover {
      filter: brightness(0.8);
    }

    .delete-button.remove {
      background-color: #FF7E7E; /* Light red background color */
      color: #fff; /* White text color */
      border: none; /* Remove button border if needed */
      padding: 10px 20px; /* Adjust padding as needed */
      border-radius: 5px; /* Add border radius for rounded corners */
      font-weight: bold; /* Adjust font weight as needed */
      margin-left: 2px; /* Add left margin for spacing */
      /* Add any other custom styles you want */
    }

    .video-column {
      width: 70%;
      float: left;
      padding-right: 40px;
    }

    .comments-column {
      width: 30%;
      float: left;
      padding-top: 60px;
      padding-right: 60px;
    }

    .w-row:after {
      content: "";
      display: table;
      clear: both;
    }

    .w-row {
      width: 100%;
      margin: 0;
      padding-left: 75px;
      padding-right: 25px;
    }

    /* Responsive styles for smaller devices */
    @media (max-width: 767px) {
      .video-column, .comments-column {
        width: 100%;
        float: none;
        border: none;
      }
    }

    .comments-container {
      width: 100%;
      min-height: 600px; /* Set the fixed height of the container */
      max-height: 600px; /* Same as min-height to make it a fixed height */
      background-color: rgba(255, 255, 255, 0.05);
      padding: 10px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      justify-content: flex-start; /* Align content to the top */
      overflow-y: auto; /* Enable vertical scrolling if content overflows */
      margin-top: 50px;
      border-radius: 10px;
      color: white;
    }

    .comments-list {
      overflow-y: auto; /* Enables scrolling for long list of comments */
      flex-grow: 1; /* Takes up available space */
      margin-bottom: 10px;
    }

    .comment-input-container {
        width: 100%; /* Match width with parent container */
        display: flex;
        flex-direction: column; /* Stack input and button vertically */
        margin-top: 10px;
    }
    
    #comment-input {
        width: 100%; /* Adjust width considering padding */
        padding: 5px 10px; /* Padding inside the text area */
        margin-bottom: 5px; /* Space between input and button */
        border: 1px solid #ccc;
        border-radius: 15px;
        resize: none;
    }

    .comment-input-container textarea,
    #submit-comment {
        width: 100%; /* Adjust width considering padding */
        box-sizing: border-box;
        padding: 10px 15px;
        background-color: rgba(255, 255, 255, 0.05); 
        color: white;
        border: none;
        border-radius: 15px;
        font-size: 16px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    #submit-comment:hover {
        background-color: #6FC3FF;
    }
    
    .comment-input-container textarea {
      resize: none; /* Prevent resizing of textarea */
      /* Other styling properties... */
    }

    .comment-submit-btn {
      width: 35%; /* Button width matches container width */
      padding: 8px 15px; /* Comfortable padding */
      background-color: #78f0d6; 
      color: white; /* White text color */
      border: none; /* No border */
      border-radius: 20px; /* Rounded corners */
      font-size: 16px; /* Suitable font size */
      cursor: pointer; /* Changes cursor to pointer on hover */
      transition: background-color 0.3s; /* Smooth transition for background color */
      margin-top: 2px; /* Space from the text area */
      margin-bottom: 2px;
      box-sizing: border-box; /* Ensure padding and border are included in width */
    }

    .comment-submit-btn:hover {
        background-color: #45bda3; 
    }

    .commenter-name {
      font-size: 0.9em;
      font-weight: bold;
      margin-bottom: 0px;
    }

    .comment-body{
      font-size: 1em;
      line-height: 1.8;
      padding-bottom: 5px;
      margin-top: 0px;
    }

    .comment {
      /* Add space between individual comments */
      margin-bottom: 12px; /* Adjust this value as needed */
    }

    html, body {
      margin: 0;
      padding: 0;
      /* Other styles... */
    }


  </style>
</head>
<body class="body-3">
  <div class="empty-div-2"></div>
  <div data-collapse="medium" data-animation="default" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar w-nav">
    <div class="nav-container w-container">
      <div class="nav-content-div">
        <a href="/home" class="brand w-nav-brand">
          <%= image_tag 'opal_transparent_logo.png', loading: 'lazy', sizes: '(max-width: 479px) 25vw, 100px', srcset: { 'opal_transparent_logo-p-500.png' => '500w', 'opal_transparent_logo-p-800.png' => '800w', 'opal_transparent_logo-p-1080.png' => '1080w', 'opal_transparent_logo-p-1600.png' => '1600w', 'opal_transparent_logo-p-2000.png' => '2000w', 'opal_transparent_logo-p-2600.png' => '2600w', 'opal_transparent_logo-p-3200.png' => '3200w', 'opal_transparent_logo.png' => '5820w' }, alt: '', class: 'logo' %>
          <div class="nav-link-div">
            <div data-w-id="b716dcca-f0d7-e553-edb3-c56183bb5160" class="nav-link-text-div">
              <% if current_user %>
                <% if current_user.favorite_films.include?(@film) %>
                  <%= form_tag(remove_from_favorites_user_path(current_user, film_id: @film.id), method: :delete) do %>
                    <%= submit_tag 'REMOVE FROM FAVORITES', class: 'nav-link w-nav-link favorite-button remove', style: 'margin-right: 10px;' %>
                  <% end %>
                <% else %>
                  <%= form_tag(add_to_favorites_user_path(current_user, film_id: @film.id), method: :post) do %>
                    <%= submit_tag 'ADD TO FAVORITES', class: 'nav-link w-nav-link favorite-button add' %>
                  <% end %>
                <% end %>
              <% else %>
                <%= link_to 'ADD TO FAVORITES', login_path, class: 'nav-link w-nav-link favorite-button add' %>
              <% end %>
            </div>
            <div data-w-id="b716dcca-f0d7-e553-edb3-c56183bb5160" class="nav-link-text-div">
              <%= link_to 'BACK', 'javascript:history.back()', class: 'nav-link w-nav-link', style: 'margin-right: 10px;' %>
              <div style="width:0px; opacity:0; display: none;" class="nav-link-underline"></div>
            </div>
          </div>
        </a>
      </div>
      <div data-w-id="b716dcca-f0d7-e553-edb3-c56183bb5172" class="nav-profile-div">
        <div data-w-id="f2188e1d-bacf-26d6-1b94-8473b5995802" class="nav-link-text-div">
          <% if current_user && @film.owned_by?(current_user) %>
            <%= link_to 'DELETE FILM', '#', method: :delete, class: 'nav-link w-nav-link delete-button remove', style: 'margin-right: 10px;', player: 'delete' %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
  <div class="w-row">
    <div class="w-col w-col-8 video-column">
      <div class="header-block-2">
        <h1 class="heading-4"><%= @film.title %></h1>
        <div class="faded-2">Director: <%= link_to @film.user.display_name, user_path(@film.user), class: 'faded-2' %></div>
      </div>
      <div class="video-box-2">
        <div data-w-id="55b4e29d-fd0d-d6ac-e589-9629fd6b7c95" class="video-wrapper-2">
          <div class="video-inner-wrapper">
            <div data-w-id="55b4e29d-fd0d-d6ac-e589-9629fd6b7c97" class="video-controls">
              <div data-w-id="55b4e29d-fd0d-d6ac-e589-9629fd6b7c98" class="video-timeline">
                <div class="video-timeline-empty">
                  <div player="timeline" class="video-timeline-fill">
                    <div class="video-level-dot"></div>
                  </div>
                </div>
              </div>
              <div class="video-control-flex">
                <div class="video-flex">
                  <div player="play" class="video-button">
                    <%= image_tag 'play-button-arrowhead-1.svg', loading: 'lazy', alt: 'Play Video', class: 'video-icon' %>
                  </div>
                  <div data-w-id="55b4e29d-fd0d-d6ac-e589-9629fd6b7ca2" class="video-volume-controls">
                    <div player="mute" class="video-button extend-right-padding">
                      <%= image_tag 'muton-volume-off.svg', loading: 'lazy', alt: 'Volume', class: 'video-icon' %>
                    </div>
                    <div class="video-volume">
                      <div class="volume-level"> 
                        <div class="volume-level-empty">
                          <div class="volume-level-fill">
                            <div class="video-level-dot"></div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="video-button no-hover-state">
                    <div player="time">0:00</div>
                    <div player="time"> / </div>
                    <div player="duration">0:00</div>
                  </div>
                </div>
                <div class="video-flex">
                  <div player="full" class="video-button">
                    <%= image_tag '005-fullscreen-symbol.svg', loading: 'lazy', alt: 'Full Screen', class: 'video-icon' %>
                  </div>
                </div>
              </div>
            </div>
            <div class="video-play-target-2"></div>
            <video autoplay="false" playsinline="" style="width:100%;max-height:100%;">
              <source src="<%= @film.film_url %>" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
        </div>
      </div>
      <p class="align-center-2"><%= @film.description %></p>
    </div>
    <div class="w-col w-col-4 comments-column">
      <div class="comments-container">
        <div class="comments-list">
          <% @comments.each do |comment| %>
            <div class="comment">
              <div class="commenter-name"><%= comment.user.display_name %></div> <!-- Display the commenter's name -->
              <div class="comment-body"><%= comment.body %></div> <!-- Display the comment's body -->
            </div>
          <% end %>
        </div>
        <div class="comment-input-container">
          <%= form_with(model: @comment, url: film_comments_path(@film), local: true) do |form| %>
            <%= form.text_area :body, placeholder: "Add a comment...", rows: 3, name: 'comment[body]', id: 'comment-input' %>
            <%= form.submit "Comment", class: "comment-submit-btn" %>
          <% end %>
        </div>
      </div>
  </div>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=6552fd9da7543edd2fe97c76" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <%= javascript_include_tag 'webflow' %>
  <script>
  document.addEventListener('DOMContentLoaded', function () {
    const videoPlayer = document.querySelector('video');
    const playButton = document.querySelector('[player="play"]');
    const fullscreenButton = document.querySelector('[player="full"]');
    const muteButton = document.querySelector('[player="mute"]');
    const playIcon = '<%= image_path("play-button-arrowhead-1.svg") %>';
    const pauseIcon = '<%= image_path("music-pause-button-pair-of-lines.svg") %>';
    const volumeIcon = '<%= image_path("001-reduced-volume.svg") %>';
    const muteIcon = '<%= image_path("muton-volume-off.svg") %>';
    const deleteButton = document.querySelector('[player="delete"]');
    const currentTimeDisplay = document.querySelector('.current-time');
    const durationDisplay = document.querySelector('.duration');
    const timelineFill = document.querySelector('.video-timeline-fill');
    const timeline = document.querySelector('.video-timeline'); // Added timeline selector

    videoPlayer.pause();

    function formatTime(timeInSeconds) {
      const minutes = Math.floor(timeInSeconds / 60);
      const seconds = Math.floor(timeInSeconds % 60);
      return `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
    }

    function updateVideoProgress() {
      const currentTime = videoPlayer.currentTime;
      const duration = videoPlayer.duration;
      currentTimeDisplay.textContent = formatTime(currentTime);
      if (durationDisplay.textContent === '0:00') {
        durationDisplay.textContent = formatTime(duration);
      }
      const playedPercentage = (currentTime / duration) * 100;
      timelineFill.style.width = `${playedPercentage}%`;
    }

    videoPlayer.addEventListener('timeupdate', updateVideoProgress);

    if (videoPlayer.muted) {
      muteButton.querySelector('img').src = muteIcon;
    } else {
      muteButton.querySelector('img').src = volumeIcon;
    }

    videoPlayer.addEventListener('play', function () {
      playButton.innerHTML = `<img src="${pauseIcon}" loading="lazy" alt="Pause Video" class="video-icon">`;
    });

    playButton.addEventListener('click', function () {
      if (videoPlayer.paused) {
        videoPlayer.play();
        playButton.innerHTML = `<img src="${pauseIcon}" loading="lazy" alt="Pause Video" class="video-icon">`;
      } else {
        videoPlayer.pause();
        playButton.innerHTML = `<img src="${playIcon}" loading="lazy" alt="Play Video" class="video-icon">`;
      }
    });

    fullscreenButton.addEventListener('click', function () {
      if (videoPlayer.requestFullscreen) {
        videoPlayer.requestFullscreen();
      } else if (videoPlayer.webkitRequestFullscreen) {
        videoPlayer.webkitRequestFullscreen();
      } else if (videoPlayer.msRequestFullscreen) {
        videoPlayer.msRequestFullscreen();
      }
    });

    muteButton.addEventListener('click', function () {
      if (videoPlayer.muted) {
        videoPlayer.muted = false;
        muteButton.querySelector('img').src = volumeIcon;
      } else {
        videoPlayer.muted = true;
        muteButton.querySelector('img').src = muteIcon;
      }
    });

    deleteButton.addEventListener('click', function (event) {
      event.preventDefault();
      const confirmed = confirm('Are you sure you want to delete this film?');
      if (confirmed) {
        const form = document.getElementById('delete-film-form');
        form.submit();
      }
    });

    let isDragging = false;

    timeline.addEventListener('mousedown', (event) => {
      isDragging = true;
      updateTimeline(event);
    });

    document.addEventListener('mousemove', (event) => {
      if (isDragging) {
        updateTimeline(event);
      }
    });

    document.addEventListener('mouseup', () => {
      isDragging = false;
    });

    function updateTimeline(event) {
      const timelineRect = timeline.getBoundingClientRect();
      const clickX = event.clientX - timelineRect.left;
      const timelineWidth = timelineRect.width;
      const seekPercentage = clickX / timelineWidth;
      const seekTime = seekPercentage * videoPlayer.duration;

      videoPlayer.currentTime = seekTime;
      timelineFill.style.width = `${seekPercentage * 100}%`;
      currentTimeDisplay.textContent = formatTime(seekTime);
    }
  });
</script>

  <%= form_tag "/delete_video/#{@film.id}", method: :delete, id: 'delete-film-form', style: 'display: none;' do %>
    <%= csrf_meta_tags %>
    <!-- Add other form fields if needed -->
    <%= submit_tag 'DELETE FILM', class: 'nav-link w-nav-link delete-button remove', style: 'margin-right: 10px;', data: { confirm: 'Are you sure you want to delete this film?' } %>
  <% end %>
</body>
</html>